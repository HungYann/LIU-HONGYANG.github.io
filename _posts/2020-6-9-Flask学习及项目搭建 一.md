---
layout: post
author: LIU,HONGYANG
tags: [Python]
---



##### 运行第一个Flask程序



- 安装flask

```shell
pip install flask
```



- 卸载flask



```shell
pip uninstall flask
```



- 打印flask版本



```
print (flask.__version__)
```



- 第一个Flask程序

  

run中参数:

debug用于是否自动编译运行程序



@app.route是一个装饰器

@app开头，并且在函数上面，说明是装饰器，用于调用debu请求



``` python
from flask import Flask

app = Flask(__name__)


@app.route('/')
def hello_world():
    a =10
    b =0
    c = a/10
    c =1
    d =2
    return "sdfs"

if __name__ == '__main__':
    app.run(debug=True,port=8000,host='0.0.0.0')
```





##### debug模式



1.新建一个`config.py`文件

```python
DEBUG=True
```



2.在主app文件中导入这个文件，并且配置到`app`中，示例代码如下：

```python
import config
app.config.from_object(config)
```



3.还有许多其它参数文件，都是放在这个配置文件中，比如`SECRET_KEY`和`SQLALCHEMY`这些都是在配置文件中



```python
from flask import Flask
import config
app = Flask(__name__)
app.config.from_object(config)

@app.route('/')

def hello_world():
    a =10
    b =0
    c = a/10
    c =1
    d =2
    return "sdfs"

if __name__ == '__main__':
    app.run()
```



![image-20200305143131295](https://tva1.sinaimg.cn/large/00831rSTgy1gcj1f9ocwrj311y096765.jpg)





##### url传参：



> 1.参数的作用，可以在相同的URL, 但是指定不同的参数，来加载不同的数据

```python
from flask import Flask
import config
app = Flask(__name__)
app.config.from_object(config)

@app.route('/')
def hello_world():
    a =10
    b =0
    c = a/10
    c =1
    d =2
    return "sdfs"

@app.route('/article/<id>')
def article(id):

    id = int(id)+2;
    return u'ther parameter is %s'%id

if __name__ == '__main__':
    app.run()
```



##### url反转



什么叫做反转URL:

从视图函数到URL的转换叫做反转URL

反转URL的作用：

- 在页面重定向的时候，会使用反转URL
- 在模版中，也会使用URL反转。



如果反转函数需要携带函数，比如id2，则在反转的过程中，就应该添加参数，否则会出错。



第二要注意的url_for的参数应该与方法名保持一致

```python
from flask import Flask,url_for

app =Flask(__name__)

@app.route('/')
def index():
    print (url_for('my_list'))
    print (url_for('article',id2='liuhongyang'))
    return "Hello World"

@app.route('/list/')
def my_list():
    return 'list'

@app.route('/article/<id2>/')
def article(id2):
    return u'您的请求id是%s'%id2


if __name__ == '__main__':
    app.run(debug=True)


```



##### 页面跳转和重定向



用处：在用户访问一些需要登录的页面的时候，如果用户没有登录，那么可以让它重定向到登录页面。



>  页面跳转









```python
from flask import Flask,redirect,url_for

app = Flask(__name__)

@app.route('/')
def index():
    login_url = url_for('login')
    return redirect(login_url)
    return u'这是首页'

@app.route('/login/')
def login():
    return u'这是登录页面'

if __name__ == '__main__':
    app.run(debug=True)

```













> 重定向



页面登录重定向：

```python
from flask import Flask,url_for,redirect

app = Flask(__name__)


@app.route('/login/')
def login():
    return u'这是登录页面';

@app.route('/article/<id2>/')
def quesion(id2):
    if id2 == '1':
        return u'这是发布者界面'
    else:
        return redirect(url_for('login'))

if __name__ == '__main__':
    app.run(debug=True)
```





##### 模版渲染和参数



- 模版放在`template`文件夹下
- 视图函数中，使用`render_template`函数渲染模版。注：只需要填写模版名字，不需要填写文件夹。

- 如果有多个路径，则`/filename/index.html`



```python
from flask import Flask,render_template

app = Flask(__name__)

@app.route('/')
def index():


    return render_template('index.html',username=u'知了课堂',gender=u'男',age=u'18')

if __name__ == '__main__':
    app.run(debug=True)
```



当有多个参数时，可以使用字典添加多个参数；使用两个**，把字典转换成关键参数传递进去。



```python
from flask import Flask,render_template

app = Flask(__name__)

@app.route('/')
def index():
    context={
        'username':u'知了课堂',
        'gender':u'男',
        'age':18
    }

    return render_template('index.html', ** context)

if __name__ == '__main__':
    app.run(debug=True)
```







![Screenshot 2020-03-06 at 00.13.43](https://tva1.sinaimg.cn/large/00831rSTgy1gcji9dm5y5j30f00ca0to.jpg)





##### 模版中访问属性和字典



模版中的参数传递

```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route("/")
def index():
    class Person():
        name = u'liu'
        age = 22

    p = Person()

    context = {
        'username' : u'知了课堂',
        'gender' : u'男',
        'age' : 18,
        'person' : p,
        'websites':{
            'baidu':'www.baidu.com',
            'google':'www.google.com'
        }
    }

    return  render_template("index.html",**context)

if __name__ == '__main__':
    app.run(debug=True)

```



```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
</head>
<body>
你好
<p>用户名:{{username}}</p>
<p>性别:{{gender}}</p>
<p>年龄:{{age}}</p>
<p></p>

<hr>
<p>名字:{{person.username}}</p>
<p>年龄:{{person.age}}</p>

<hr>
<p>{{websites.baidu}}</p>
<p>{{websites.google}}</p>

</body>
</html>
```



##### if 判断语句



```python
from flask import Flask,render_template

app = Flask(__name__)

@app.route('/<login>/')
def index(login):
    if login == '1':

        user = {
            'username':'liuhongyang'
        }

        return render_template('index.html',user=user)
    else:
        return render_template('index.html')


if __name__ == '__main__':
    app.run(debug=True)
```



```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
</head>
<body>
    {% if user %}
        <a href="#">{{ user.username }}</a>
        <a href="#">注销</a>
    {% else %}
        <a href="#">登录</a>
        <a href="#">注册</a>
    {% endif %}
</body>
</html>
```






